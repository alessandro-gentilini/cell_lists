<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Fixed-Radius Nearest Neighbors Search &#8212; Cell Lists 0.1 documentation</title>
    
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Benchmarks" href="benchmarks.html" />
    <link rel="prev" title="Cell Lists" href="index.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body role="document">
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <span class="target" id="module-cell_lists.cell_lists"></span><div class="section" id="fixed-radius-nearest-neighbors-search">
<h1>Fixed-Radius Nearest Neighbors Search<a class="headerlink" href="#fixed-radius-nearest-neighbors-search" title="Permalink to this headline">¶</a></h1>
<p>Cell lists algorithm partitions space into grid and sorts points into a cell in
discrete grid, allowing <em>fast nearest neighbor searches</em> for <em>fixed radius</em>
because it is only necessary to search current and neighboring cells for points
instead of the whole domain.</p>
<div class="section" id="inserting-the-points-into-cells">
<h2>Inserting the Points into Cells<a class="headerlink" href="#inserting-the-points-into-cells" title="Permalink to this headline">¶</a></h2>
<p>Point in <span class="math">\(n \in \mathbb{N}\)</span> dimension is denoted</p>
<div class="math">
\[\mathbf{p}_i \in \mathbb{R}^n\]</div>
<p>An sequence of points of size <span class="math">\(N\)</span>, for which index set is
<span class="math">\(J = \{0,\ldots ,N-1\}\)</span>, is denoted</p>
<div class="math">
\[(\mathbf{p}_i)_{i \in J}\]</div>
<p>A cell of size <span class="math">\(c &gt; 0\)</span> for point <span class="math">\(i\)</span> is calculated</p>
<div class="math">
\[\mathbf{c}_i = \left\lfloor \frac{\mathbf{p}_i}{c} \right\rfloor\]</div>
<p>Algorithm</p>
<ol class="arabic simple">
<li>Compute the shape of the grid</li>
<li>Add ghost cells into the shape</li>
<li>Count the number of points that belong to each cell</li>
<li>Cumulative sum of the counts</li>
<li>Sort the indices of the points in order which they appear in the cells and
store them in an array.</li>
</ol>
</div>
<div class="section" id="finding-nearest-neighbors">
<h2>Finding Nearest Neighbors<a class="headerlink" href="#finding-nearest-neighbors" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="computational-complexity">
<h2>Computational Complexity<a class="headerlink" href="#computational-complexity" title="Permalink to this headline">¶</a></h2>
<p>Brute force</p>
<div class="math">
\[\mathcal{O}(N^2)\]</div>
<p>Cell lists</p>
<div class="math">
\[\mathcal{O}(N k)\]</div>
</div>
<div class="section" id="memory-usage">
<h2>Memory Usage<a class="headerlink" href="#memory-usage" title="Permalink to this headline">¶</a></h2>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="frnns" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[FRNNS]</td><td>Fixed-radius near neighbors. (2017). En.wikipedia.org. Retrieved 10 July 2017, from <a class="reference external" href="https://en.wikipedia.org/wiki/Fixed-radius_near_neighbors">https://en.wikipedia.org/wiki/Fixed-radius_near_neighbors</a></td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="celllists" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[celllists]</td><td>Cell lists. (2017). En.wikipedia.org. Retrieved 10 July 2017, from <a class="reference external" href="https://en.wikipedia.org/wiki/Cell_lists">https://en.wikipedia.org/wiki/Cell_lists</a></td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="bentley75" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[Bentley75]</td><td>Bentley, J. L. (1975). A Survey of techniques for fixed radius near neighbor searching, 37.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="lecture2" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[Lecture2]</td><td>Lecture 2 : Fixed-Radius Near Neighbors and Geometric Basics. (1977), 5–16.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="hoetzlein14" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[Hoetzlein14]</td><td>Hoetzlein, R. (2014). Fast Fixed-Radius Nearest Neighbors: Interactive Million-Particle Fluids. GPU Technology Conference.</td></tr>
</tbody>
</table>
<hr class="docutils" />
<dl class="attribute">
<dt id="cell_lists.cell_lists.add_to_cells">
<code class="descclassname">cell_lists.cell_lists.</code><code class="descname">add_to_cells</code><a class="reference internal" href="_modules/cell_lists/cell_lists.html#add_to_cells"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cell_lists.cell_lists.add_to_cells" title="Permalink to this definition">¶</a></dt>
<dd><p>Sorts the indices of the points into the grid by the given cell size.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>points</strong> (<em>array of floats</em>) &#8211; A sequence points <span class="math">\(\mathbf{p}_i\)</span> that we want to search for
nearest neighbors.</li>
<li><strong>cell_size</strong> (<em>float</em>) &#8211; Positive real number <span class="math">\(c &gt; 0\)</span> denoting the cell size of the grid.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><p>Tuple of arrays where the elements are</p>
<ul class="simple">
<li><strong>points_indices</strong> &#8211; Array of integers for querying the indices of
nearest neighbors.</li>
<li><strong>cells_count</strong> &#8211; Array of integers denoting the number of points
inside each cell.</li>
<li><strong>cells_offset</strong> &#8211; Array of integers denoting the offset index for
each cell in <strong>points_indices</strong> array.</li>
<li><strong>grid_shape</strong> &#8211; Array of integers denoting the shape of the output grid.</li>
</ul>
</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(numpy.ndarray, numpy.ndarray, numpy.ndarray, numpy.ndarray)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="cell_lists.cell_lists.find_points_in_cell">
<code class="descclassname">cell_lists.cell_lists.</code><code class="descname">find_points_in_cell</code><a class="reference internal" href="_modules/cell_lists/cell_lists.html#find_points_in_cell"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cell_lists.cell_lists.find_points_in_cell" title="Permalink to this definition">¶</a></dt>
<dd><p>Return indices of points inside cell of cell_index.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>cell_index</strong> &#8211; </li>
<li><strong>points_indices</strong> &#8211; </li>
<li><strong>cells_count</strong> &#8211; </li>
<li><strong>cells_offset</strong> &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">numpy.ndarray</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="cell_lists.cell_lists.iter_nearest_neighbors">
<code class="descclassname">cell_lists.cell_lists.</code><code class="descname">iter_nearest_neighbors</code><a class="reference internal" href="_modules/cell_lists/cell_lists.html#iter_nearest_neighbors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cell_lists.cell_lists.iter_nearest_neighbors" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterate over cell lists</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>cell_indices</strong> &#8211; Indices of the cells to which iterate over.
<cite>np.arange(len(cells_count))</cite></li>
<li><strong>neigh_cells</strong> &#8211; </li>
<li><strong>points_indices</strong> &#8211; </li>
<li><strong>cells_count</strong> &#8211; </li>
<li><strong>cells_offset</strong> &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Yields:</th><td class="field-body"><p class="first last"><em>(int, int)</em> &#8211; Tuple of indices of a pair of nearest neighbors.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="cell_lists.cell_lists.neighboring_cells">
<code class="descclassname">cell_lists.cell_lists.</code><code class="descname">neighboring_cells</code><span class="sig-paren">(</span><em>grid_shape</em>, <em>distance=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cell_lists/cell_lists.html#neighboring_cells"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cell_lists.cell_lists.neighboring_cells" title="Permalink to this definition">¶</a></dt>
<dd><p>Neighboring cells.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>grid_shape</strong> &#8211; </li>
<li><strong>distance</strong> (<em>int</em>) &#8211; The maximum distance <span class="math">\(d \in \mathbb{N}\)</span> of nearest neighboring
cells.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Array of differences of the indices of neighboring cells.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">numpy.ndarray</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="cell_lists.cell_lists.split_into_parts">
<code class="descclassname">cell_lists.cell_lists.</code><code class="descname">split_into_parts</code><a class="reference internal" href="_modules/cell_lists/cell_lists.html#split_into_parts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cell_lists.cell_lists.split_into_parts" title="Permalink to this definition">¶</a></dt>
<dd><p>Split cells equally by the amount of interactions between agents in
an cell and neighboring cells.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>n</strong> (<em>int</em>) &#8211; Number of parts to split cells.</li>
<li><strong>neigh_cells</strong> &#8211; </li>
<li><strong>cells_count</strong> &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Array of the indices to slice the array for the splits.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">numpy.array</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Fixed-Radius Nearest Neighbors Search</a><ul>
<li><a class="reference internal" href="#inserting-the-points-into-cells">Inserting the Points into Cells</a></li>
<li><a class="reference internal" href="#finding-nearest-neighbors">Finding Nearest Neighbors</a></li>
<li><a class="reference internal" href="#computational-complexity">Computational Complexity</a></li>
<li><a class="reference internal" href="#memory-usage">Memory Usage</a></li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="index.html" title="previous chapter">Cell Lists</a></li>
      <li>Next: <a href="benchmarks.html" title="next chapter">Benchmarks</a></li>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/cell_lists.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;Jaan Tollander de Balsch.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.5.5</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
      |
      <a href="_sources/cell_lists.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>